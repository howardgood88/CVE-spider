# CVE-spider
Crawl RCE type CVEs that have snort rule.

# 執行方式
`py spider.py`

# 功能
從 https://www.opencve.io/cve 爬取CVE資料，以keyword搜尋結果逐一比對以下條件：
1. 年份是否包含於定義(定義於Conditions['years'])
2. CVE Score是否大於定義(定義於Conditions['cve_score'])
3. CVE Description是否包含"code exec"字串，用來辨別是否為RCE type
4. google搜尋關鍵字"CVE-XXXX-XXXX snort rule"前5項搜尋結果的domain name是否是 https://www.snort.org 或 https://blog.snort.org ，取前五項是因為googlesearch這個套件的搜尋結果與一般使用者手動搜尋的結果不太一樣(也可能是google的個人化設計問題，但我的google帳號與無痕的搜尋結果是差不多的)，不知為何很多CVE會搜尋到不相干的snort link，因此取前五項基本上只會多找而不會漏找

以上條件皆符合者，以「CVE_id - Snort_link」形式記錄於檔案中，檔案最後寫入的是各snort link的出現次數(以出現次數由大到小排)，為debug用
  
因為要防google block，因此制定了搜尋的間隔秒數比重，每次搜尋從中雖機挑出一個數字做為間隔時間，使搜尋間隔時而長時而短，以盡量模擬真實使用者，但導致程式要跑很久，因此可以早早開始跑

# 可調參數 (Main function的Adjustable parameters處)
1. keyword：等同 https://www.opencve.io/cve?search=keyword
2. starting_page：起始頁數，會由此數往下逐一代入 https://www.opencve.io/cve?search=keyword&page=X ，直到404 Error
3. pause_sec_list：google搜尋的間隔秒數的"比重"，每次會從list中隨機挑出一個作為該次的間隔秒數
